[基于docusaurus的静态博客网站](https://www.zxsvici.top/docs/personal-project/study/docusaurus-blog/)

## 快速开始
[快速上手](https://docusaurus.io/)

### 配置导航
配置侧边栏
```js title='sidebars.js'
/**
 * Creating a sidebar enables you to:
 - create an ordered group of docs
 - render a sidebar for each doc of that group
 - provide next/previous navigation

 The sidebars can be generated from the filesystem, or explicitly defined here.

 Create as many sidebars as you want.
 */

// @ts-check

/** @type {import('@docusaurus/plugin-content-docs').SidebarsConfig} */
const sidebars = {
  // By default, Docusaurus generates a sidebar from the docs folder structure
  tutorialSidebar: [{type: 'autogenerated', dirName: '.'}],

  //可声明多个使用
  projectSidebar: [
    {
      type: 'autogenerated', // 表示顶级
      dirName: 'personal-project', // xx 实际路径是 ./docs/xx
    },
  ],

};

export default sidebars;
```
配置
```js title='docusaurus.config.js'
    themeConfig: ({
        //**
        navbar: {
            items: [
                // **
                {
                    type: 'docSidebar', // 表明是导航
                    sidebarId: 'projectSidebar', //侧边栏，对应自己的配置
                    label: '项目经验', // 导航栏显示名称
                    position: "left" // 左对齐
                },
            ]
        }
    })
```

### 配置代码高亮插件
默认情况下，不支持powershell、Java等等
需要添加以下配置
```jsx title='docusaurus.config.js'
    themeConfig: ({
        //**
        prism: {
            theme: prismThemes.github,
            darkTheme: prismThemes.dracula,
            additionalLanguages: ['java','powershell','lua','python','go'] //在这里面添加你想要的，shell有问题，不要配置了，会白屏无法访问
        },
    })
```

### 配置搜索
```shell
npm i docusaurus-lunr-search  --save
```
加载插件
```js title='docusaurus.config.js'
    plugins: [[ require.resolve('docusaurus-lunr-search'), {
        languages: ['en','zh'] // language codes
    }]]
```
如果需要配置成支持中文还需要添加 @node-rs/jieba依赖
```shell
npm install @node-rs/jieba
```
此插件需要打包生成索引才可生效，所以开发时会一直显示loading，打包运行就会回复正常。<br/>
![dev_running](./docs/personal-project/docusaurus-blog/img/search_build_running.png)
![build_running](./docs/personal-project/docusaurus-blog/img/search_build_running.png)

## shell 定时脚本
```shell title='blog_rebuild_task.sh'
#!/bin/bash

git_repo_path="repository_path"

cd "$git_repo_path"

git pull

current_commit=$(git rev-parse HEAD)

previous_commit=$(cat .previous_commit 2>/dev/null)

blog_rebuild_log = "/tmp/blog_rebuild.log"

if [ -z "$previous_commit" ] || [ "$current_commit" != "$previous_commit" ]; then
  npm run build > "$blog_rebuild_log" 2>&1
  # 记录和更新
  echo "$(date '+%Y-%m-%d %H:%M:%S') - Ran npm run build" >> task.log
  echo "$current_commit" > .previous_commit

  # 邮件收件人地址
  recipient="your@email.com"
  # 邮件主题
  subject="rebuild error"
  # 邮件内容
  body="sb, rebuild error.msg is \n${cat "$blog_rebuild_log"}"

  # 使用 mail 命令发送邮件
  echo -e "$body" | mail -s "$subject" "$recipient"
else
  echo "Versions are the same"
fi
```

配置定时器
```shell
crontab -e
# 根据自己需要配置，因为博客对时延不敏感，脚本运行消耗不大,所以可以去一个宽松的时间
*/15 * * * * * /path/blog_rebuild_task.sh
```